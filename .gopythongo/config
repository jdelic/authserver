builder=pbuilder
distribution=stretch

assembler=[certifybuild, django]

django-gen-secret-key=.gopythongo/etc/appconfig/authserver/env/SECRET_KEY
django-settings=authserver.settings
collect-static

vaultgetcert-config=[.gopythongo/authserver.vgc, .gopythongo/dkimsigner.vgc, .gopythongo/mailforwarder.vgc]

# local build options
basetgz=/var/cache/pbuilder/authserver-dev.tgz
pbuilder-create-opts="--keyring /etc/apt/trusted.gpg --debootstrapopts --keyring=/etc/apt/trusted.gpg --mirror http://fileserver.maurusnet.test/debian"
install-pkg=[libssl-dev, libffi-dev, libpq-dev]
run-after-create=[.gopythongo/install_fpm.sh]
packer=fpm

store=aptly
use-aptly-vault-wrapper
aptly-config=/etc/aptly/aptly.conf
# reference for build server
aptly-publish-opts="-config=/etc/aptly/aptly.conf -architectures=amd64 -keyring=/etc/gpg-managed-keyring/pubring.gpg -secret-keyring=/etc/gpg-managed-keyring/secring.gpg -gpg-key=DDB131CF1DF6A9CF8200799002CBD940A78049AF"

versioner=searchfile
search-version-in=authserver/authserver/__init__.py
version-parser=pep440
version-action=bump-revision

use-fpm=/usr/local/bin/fpm
run-fpm=[template:.gopythongo/fpm_opts, template:.gopythongo/fpm_opts.authclient]

eatmydata
eatmydata-path=/usr/bin/eatmydata
